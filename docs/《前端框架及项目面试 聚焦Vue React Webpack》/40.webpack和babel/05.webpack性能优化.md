---
title: webpack性能优化
date: 2021-03-10 16:26:25
permalink: /pages/655d08/
categories:
  - 《前端框架及项目面试 聚焦Vue React Webpack》
  - webpack和babel
tags:
  - 
---

* 大厂必考&社区热议话题
* 优化打包构建速度-开发体验和效率
* 优化产出代码-产品性能

## 构建速度

* 优化babel-loader
* IgnorePlugin
* noParse
* happyPack
* ParallelUglifyPlugin
* 自动刷新
* 热更新
* DllPlugin

## 优化babel-loader

``` js
{
  test: /\.js$/,
  use: ['babel-loader?cacheDirectory'], //开启缓存
  include: path.resolve(__dirname, 'src'), //明确范围
  // //排除范围，include 和exclude 两者选一个即可
  // exclude: path.resolve(__dirname, 'node_ modules')
},
```

## happyPack多进程打包

* JS 单线程,开启多进程打包
* 提高构建速度(特别是多核CPU )

## ParallelUglifyPlugin多进程压缩JS

* webpack 内置Uglify工具压缩JS
* JS 单线程，开启多进程压缩更快
* 和happyPack同理

## 关于开启多进程

* 项目较大,打包较慢,开启多进程能提高速度
* 项目较小，打包很快,开启多进程会降低速度(进程开销)
* 按需使用

::: details webpack.prod.js
<<< @/code/frame-project-interview/webpack-demo/build-optimization/webpack.prod.js{8,23-30,85-91,9,93-112}
:::

## 自动刷新

``` js
module.export = {
  watch: true, //开 启监听，默认为false
  // 注意，开启监听之后，webpack-dev-server 会自动开启刷新浏览器! ! !
  // 监听配置
  watchOptions: {
    ignored: /node_modules/, // 忽略哪些
    // 监听到变化发生后会等300ms再去执行动作，防止文件更新太快导致重新编译频率太高
    aggregateTimeout: 300, // 默认为 300ms
    // 判断文件是否发生变化是通过不停的去询问系统指定文件有没有变化实现的
    poll: 1000 //默认每隔1000毫秒询问一次
  }
}
```

## 热更新

* 自动刷新:整个网页全部刷新,速度较慢
* 自动刷新:整个网页全部刷新,状态会丢失
* 热更新:新代码生效，网页不刷新,状态不丢失
::: details webpack.dev.js
<<< @/code/frame-project-interview/webpack-demo/build-optimization/webpack.dev.js{6,12-16,54,63}
:::
::: details index.js
<<< @/code/frame-project-interview/webpack-demo/src/index.js{10-16}
:::
